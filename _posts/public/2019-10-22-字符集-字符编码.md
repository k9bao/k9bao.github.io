---
layout: post
title: 字符集-字符编码
date: 2019-11-08 17:45:20
description: 字符集-字符编码
tag: public

---



- [字符集-字符编码](#字符集-字符编码)
  - [概念简介](#概念简介)
    - [1.什么是字符？](#1什么是字符)
    - [2.什么是字符集？](#2什么是字符集)
    - [3.什么是字符编码？](#3什么是字符编码)
    - [4.字符集分类](#4字符集分类)
      - [1.ASCII字符集](#1ascii字符集)
      - [2.ISO 8859字符集](#2iso-8859字符集)
      - [3.GB2312字符集](#3gb2312字符集)
      - [4.GB18030字符集](#4gb18030字符集)
      - [5.Unicode字符集](#5unicode字符集)
      - [6.BIG5字符集](#6big5字符集)
    - [5.字符编码分类](#5字符编码分类)
      - [1.ASCII码](#1ascii码)
      - [2.GB2321](#2gb2321)
      - [3.GBK](#3gbk)
      - [4.GB18030](#4gb18030)
      - [5.UTF-8](#5utf-8)
      - [6.UTF-16](#6utf-16)
    - [6.Little endian 和 Big endian](#6little-endian-和-big-endian)
    - [7.UCS-2、UCS-4、BMP](#7ucs-2ucs-4bmp)
    - [8.BOM](#8bom)
    - [9.内码和代码页(code page)](#9内码和代码页code-page)
    - [10.Big5](#10big5)
  - [参考资料](#参考资料)

# 字符集-字符编码
## 概念简介
### 1.什么是字符？
    字符是各种文字和符号的总称，包括各个国家文字、标点符号、图形符号、数字等。
### 2.什么是字符集？
    字符集是多个字符的集合，字符集种类较多，每个字符集包含的字符个数不同，常见字符集有：ASCII字符集、ISO 8859字符集、GB2312字符集、BIG5字符集、GB18030字符集、Unicode字符集等
### 3.什么是字符编码？
    1. 计算机要准确的处理各种字符集文字，需要进行字符编码，以便计算机能够识别和存储各种文字。
    2. 字符编码(encoding)和字符集不同。字符集只是字符的集合，不一定适合作网络传送、处理，有时须经编码(encode)后才能应用。如Unicode可依不同需要以UTF-8、UTF-16、UTF-32等方式编码。
    3. 字符编码就是以二进制的数字来对应字符集的字符。 因此，对字符进行编码，是信息交流的技术基础。
    4. 各个国家和地区在制定编码标准的时候，“字符的集合”和“编码”一般都是同时制定的。因此，平常我们所说的“字符集”，比如：GB2312, GBK, JIS 等，除了有“字符的集合”这层含义外，同时也包含了“编码”的含义。
    5. 注意：Unicode字符集有多种编码方式，如UTF-8、UTF-16等；ASCII只有一种；大多数MBCS（包括GB2312，GBK）也只有一种。
### 4.字符集分类
#### 1.ASCII字符集
    同ASCII编码
#### 2.ISO 8859字符集
    同ISO 8859编码
#### 3.GB2312字符集
    同GB2312编码
#### 4.GB18030字符集
    同GB18030编码
#### 5.Unicode字符集
    Unicode的学名是"UniversalMultiple-Octet Coded Character Set"，简称为UCS
    供4字节32位,根据最高位为0的最高字节分成2^7=128个group。每个group再根据次高字节分为2^8=256个plane。每个plane根据第3个字节分为2^8=256行 (rows)，每行包含256个cells。当然同一行的cells只是最后一个字节不同，其余都相同。工具2^127个编码.
    0XXXXXXX XXXXXXXX XXXXXXX XXXXXXXX
    group128 plane256 rows256 cells256

    Unicode是国际组织制定的可以容纳世界上所有文字和符号的字符编码方案。目前的Unicode字符分为17组编排，0x0000至0x10FFFF，每组称为平面（Plane），而每平面拥有65536个码位，共1114112个。然而目前只用了少数平面。UTF-8、UTF-16、UTF-32都是将数字转换到程序数据的编码方案。它只是规定了所有符号的二进制代码。
#### 6.BIG5字符集

### 5.字符编码分类
#### 1.ASCII码
    是西欧编码的方式，采取7位编码，所以是2^7=128,共可以表示128个字符，包括34个字符，（如换行LF，回车CR等），其余94位为英文字母和标点符号及运算符号等。
    字符集：从符号(NUL=”/0”=“空操作字符”）到“Z”再到“DEL”符号
    字符编码范围：二进制：00000000——01111111 十进制：0-127
    占用字节：1字节 8bit 盘片储存方式：凹凹凹凹凹凹凹凹——凸凸凸凸凸凸凸凸
#### 2.GB2321
    GB2312 是对 ASCII 的中文扩展。兼容ASCII。
    编码规定：
    编码小于127的字符与ASCII编码相同，
    特性：两个大于127的字符连在一起时，就表示一个汉字，前面的一个字节（称之为高字节）从0xA1用到0xF7，后面一个字节（低字节）从0xA1到0xFE，这样我们就可以组合出大约7000多个简体汉字了。

    字符集:从符号(NUL=”/0”=“空操作字符”）到“Z”到“齄”(简体中文）
    字符编码范围：16进制：0x0000-(中间有一部分是未使用的)-0xF7FE
    占用字节：英文 1字节 8bit 盘片储存方式：凹凹凹凹凹凹凹凹——凸凸凸凸凸凸凸凸
    中文 2字节 16bit 凹凹凹凹凹凹凹凹凹凹凹凹凹凹凹凹——…
#### 3.GBK
    GBK 兼容ASCLL 兼容 GB2312 是GB2312的扩展
    但是中国的汉字太多了，我们很快就就发现有许多人的人名没有办法在这里打出来，不得不继续把 GB2312 没有用到的码位找出来用上。后来还是不够用，于是干脆不再要求低字节一定是127号之后的内码，只要第一个字节是大于127就固定表示这是一个汉字的开始，不管后面跟的是不是扩展字符集里的内容。结果扩展之后的编码方案被称为 “GBK” 标准，GBK 包括了 GB2312 的所有内容，同时又增加了近20000个新的汉字（包括繁体字）和符号。
#### 4.GB18030
    GB18030 兼容GBK 是GBK的扩展
    也就是说 GB18030 > GBK > GB2312。 这一系列的中文编码，称为 DBCS(Double Byte Character Set 双字节字符集)。
    
    2000年的GB18030是取代GBK1.0的正式国家标准。该标准收录了27484个汉字，同时还收录了藏文、蒙文、维吾尔文等主要的少数民族文字。从汉字字汇上说，GB18030在GB13000.1的20902个汉字的基础上增加了CJK扩展A的6582个汉字（Unicode码0x3400-0x4db5），一共收录了27484个汉字。

    CJK就是中日韩的意思。Unicode为了节省码位，将中日韩三国语言中的文字统一编码。GB13000.1就是ISO/IEC 10646-1的中文版，相当于Unicode 1.1。

    GB18030的编码采用单字节、双字节和4字节方案。其中单字节、双字节和GBK是完全兼容的。4字节编码的码位就是收录了CJK扩展A的6582个汉字。例如：UCS的0x3400在GB18030中的编码应该是8139EF30，UCS的0x3401在GB18030中的编码应该是8139EF31。

    微软提供了GB18030的升级包，但这个升级包只是提供了一套支持CJK扩展A的6582个汉字的新字体：新宋体-18030，并不改变内码。Windows 的内码仍然是GBK。
    在DBCS系列标准里，最大的特点是两字节长的汉字字符和一字节长的英文字符并存于同一套编码方案里，因此他们写的程序为了支持中文处理，必须要注意字串里的每一个字节的值，如果这个值是大于127的，那么就认为一个双字节字符集里的字符出现了。
#### 5.UTF-8
    UTF-8（8-bit Unicode Transformation Format）是一种针对Unicode的可变长度字符编码，也是一种前缀码。它可以用来表示Unicode标准中的任何字符，且其编码中的第一个字节仍与ASCII兼容，这使得原来处理ASCII字符的软件无须或只须做少部分修改，即可继续使用。因此，它逐渐成为电子邮件、网页及其他存储或发送文字的应用中，优先采用的编码。
    从Unicode到UTF-8的编码方式如下：
    UTF-8的特点是对不同范围的字符使用不同长度的编码。对于0x00-0x7F之间的字符，UTF-8编码与ASCII编码完全相同。UTF-8编码的最大长度是6个字节。从上表可以看出，6字节模板有31个x，即可以容纳31位二进制数字。Unicode的最大码位0x7FFFFFFF也只有31位。
    允许含BOM，但通常不含BOM。中文使用24为（三个字节）来编码。UTF-8包含全世界所有国家需要用到的字符，是国际编码，通用性强。UTF-8编码的文字可以在各国支持UTF8字符集的浏览器上显示。如，如果是UTF8编码，则在外国人的英文IE上也能显示中文，他们无需下载IE的中文语言支持包。
    例1：“汉”字的Unicode编码是0x6C49。0x6C49在0x0800-0xFFFF之间，使用用3字节模板了：1110xxxx 10xxxxxx 10xxxxxx。将0x6C49写成二进制是：0110 1100 0100 1001， 用这个比特流依次代替模板中的x，得到：11100110 10110001 10001001，即E6 B1 89。

#### 6.UTF-16
    UTF-16（16-bit Unicode Transformation Format）是一种针对Unicode的定长长度字符编码，也是一种前缀码。它可以用来表示Unicode标准中的任何字符
    UTF-16以16位为单元对UCS进行编码。对于小于0x10000的UCS码，UTF-16编码就等于UCS码对应的16位无符号整数。对于不小于0x10000的UCS码，定义了一个算法。
    UTF-16 能表示的字符数有 6 万多，看起来很多，但是实际上目前 Unicode 5.0 收录的字符已经达到 99024 个字符，早已超过 UTF-16 的存储范围；这直接导致 UTF-16 地位颇为尴尬——如果谁还在想着只要使用 UTF-16 就可以高枕无忧的话，恐怕要失望了。

### 6.Little endian 和 Big endian
    上一节已经提到，UCS-2 格式可以存储 Unicode 码（码点不超过0xFFFF）。以汉字"严"为例，Unicode 码是4E25，需要用两个字节存储，一个字节是4E，另一个字节是25。存储的时候，4E在前，25在后，这就是 Big endian 方式；25在前，4E在后，这是 Little endian 方式。

    第一个字节在前，就是"大头方式"（Big endian,和编码集一致），第二个字节在前就是"小头方式"（Little endian）。我们一般将endian翻译成“字节序”，将big endian和little endian称作“大尾”和“小尾”。(这两个古怪的名称来自英国作家斯威夫特的《格列佛游记》。在该书中，小人国里爆发了内战，战争起因是人们争论，吃鸡蛋时究竟是从大头(Big-endian)敲开还是从小头(Little-endian)敲开。为了这件事情，前后爆发了六次战争，一个皇帝送了命，另一个皇帝丢了王位。)
    那么很自然的，就会出现一个问题：计算机怎么知道某一个文件到底采用哪一种方式编码？

    Unicode 规范定义，每一个文件的最前面分别加入一个表示编码顺序的字符，这个字符的名字叫做"零宽度非换行空格"（zero width no-break space），用FEFF表示。这正好是两个字节，而且FF比FE大1。如果一个文本文件的头两个字节是FE FF，就表示该文件采用大头方式；如果头两个字节是FF FE，就表示该文件采用小头方式。

    下面，举一个实例。
    打开"记事本"程序notepad.exe，新建一个文本文件，内容就是一个严字，依次采用ANSI，Unicode，Unicode big endian和UTF-8编码方式保存。

    然后，用文本编辑软件UltraEdit 中的"十六进制功能"，观察该文件的内部编码方式。
    1）ANSI：文件的编码就是两个字节D1 CF，这正是严的 GB2312 编码，这也暗示 GB2312 是采用大头方式存储的。
    2）Unicode：编码是四个字节FF FE 25 4E，其中FF FE表明是小头方式存储，真正的编码是4E25。
    3）Unicode big endian：编码是四个字节FE FF 4E 25，其中FE FF表明是大头方式存储。
    4）UTF-8：编码是六个字节EF BB BF E4 B8 A5，前三个字节EF BB BF表示这是UTF-8编码，后三个E4B8A5就是严的具体编码，它的存储顺序与编码顺序是一致的。

### 7.UCS-2、UCS-4、BMP
    UCS有两种格式：UCS-2和UCS-4。顾名思义，UCS-2就是用两个字节编码，UCS-4就是用4个字节（实际上只用了31位，最高位必须为0）编码。下面让我们做一些简单的数学游戏：

    UCS-2:有2^16=65536个码位，UCS-4有2^31=2147483648个码位。

    UCS-4:根据最高位为0的最高字节分成2^7=128个group。每个group再根据次高字节分为256个plane。每个plane根据第3个字节分为256行 (rows)，每行包含256个cells。当然同一行的cells只是最后一个字节不同，其余都相同。

    BMP:一个特殊的UCS-4,group=0且plane=0的UCS-4被称作Basic Multilingual Plane, 即BMP。或者说UCS-4中，高两个字节为0的码位被称作BMP。

    将UCS-4的BMP去掉前面的两个零字节就得到了UCS-2。在UCS-2的两个字节前加上两个零字节，就得到了UCS-4的BMP。而目前的UCS-4规范中还没有任何字符被分配在BMP之外。

### 8.BOM
    BOM是用来表明多字节编码的编码顺序的,主要指FEFF字符

    UCS编码中有一个特殊的字符FEFF("起名叫:ZERO WIDTH NO-BREAKSPACE"),此字符实际不会使用;同时FFFE在UCS中是不存在的字符，所以实际传输中也不应该出现.所以UCS规范建议我们在传输字节流前，先传输字符"ZERO WIDTH NO-BREAK SPACE"。这样如果接收者收到FEFF，就表明这个字节流是Big-Endian的；如果收到FFFE，就表明这个字节流是Little-Endian的。因此字符"ZERO WIDTH NO-BREAK SPACE"又被称作BOM。

    UTF-16或UTF-32编码的文件或传输的内容,开头肯定有BOM来标识字节序.

    UTF-8不需要BOM来表明字节顺序，但可以用BOM来表明编码方式。字符"ZERO WIDTH NO-BREAKSPACE"的UTF-8编码是EF BB BF（读者可以用我们前面介绍的编码方法验证一下）。所以如果接收者收到以EF BB BF开头的字节流，就知道这是UTF-8编码了。

    notepad++的编码选项有utf-8和utf-8-bom二个编码选项,二者的唯一区别是后者比前者文件开头多一个BOM(也就是FEFF使用utf-8编码后的字符EF BB BF)

    Windows就是使用BOM来标记文本文件的编码方式的。

### 9.内码和代码页(code page)
    内码就是内部使用的编码,目前Windows的内核已经支持Unicode字符集，这样在内核上可以支持全世界所有的语言文字。但是由于现有的大量程序和文档都采用了某种特定语言的编码，例如GBK，Windows不可能不支持现有的编码，而全部改用Unicode。

    所谓代码页(code page)就是针对一种语言文字的字符编码。例如GBK的code page是CP936，BIG5的code page是CP950，GB2312的code page是CP20936。
    微软也为GB18030定义了code page：CP54936。但是由于GB18030有一部分4字节编码，而Windows的代码页只支持单字节和双字节编码，所以这个code page是无法真正使用的。

    Windows中有缺省代码页的概念，即缺省用什么编码来解释字符。例如Windows的记事本打开了一个文本文件，里面的内容是字节流：BA、BA、D7、D6。Windows应该去怎么解释它呢？

    是按照Unicode编码解释、还是按照GBK解释、还是按照BIG5解释，还是按照ISO8859-1去解释？如果按GBK去解释，就会得到“汉字”两个字。按照其它编码解释，可能找不到对应的字符，也可能找到错误的字符。所谓“错误”是指与文本作者的本意不符，这时就产生了乱码。
    
    答案是Windows按照当前的缺省代码页去解释文本文件里的字节流。缺省代码页可以通过控制面板的区域选项设置。记事本的另存为中有一项ANSI，其实就是按照缺省代码页的编码方法保存。

    Windows的内码是Unicode，它在技术上可以同时支持多个代码页。只要文件能说明自己使用什么编码，用户又安装了对应的代码页，Windows就能正确显示，例如在HTML文件中就可以指定charset。

### 10.Big5
    在台湾、香港与澳门地区，使用的是繁体中文字符集。而1980年发布的GB2312面向简体中文字符集，并不支持繁体汉字。在这些使用繁体中文字符集的地区，一度出现过很多不同厂商提出的字符集编码，这些编码彼此互不兼容，造成了信息交流的困难。为统一繁体字符集编码，1984年，台湾五大厂商宏碁、神通、佳佳、零壹以及大众一同制定了一种繁体中文编码方案，因其来源被称为五大码，英文写作Big5，后来按英文翻译回汉字后，普遍被称为大五码。

    大五码是一种繁体中文汉字字符集，其中繁体汉字13053个，808个标点符号、希腊字母及特殊符号。大五码的编码码表直接针对存储而设计，每个字符统一使用两个字节存储表示。第1字节范围81H－FEH，避开了同ASCII码的冲突，第2字节范围是40H－7EH和A1H－FEH。因为Big5的字符编码范围同GB2312字符的存储码范围存在冲突，所以在同一正文不能对两种字符集的字符同时支持。

    Big5码是一套双字节字符集，使用了双八码存储方法，以两个字节来安放一个字。第一个字节称为"高位字节"，第二个字节称为"低位字节"。"高位字节"使用了0x81-0xFE，"低位字节"使用了0x40-0x7E，及0xA1-0xFE。

## 参考资料
1. [深入理解-字符编码ASCII,GB2312,GBK,Unicode,UTF-8](https://blog.csdn.net/softwarenb/article/details/51994943)
2. [GBK, GB2312, UTF-8, Unicode,encodeURI, escape的区别和联系](https://sevencai.github.io/2018/02/27/GBK-GB2312-UTF-8-Unicode-encodeURI-escape%E7%9A%84%E5%8C%BA%E5%88%AB%E5%92%8C%E8%81%94%E7%B3%BB/)
3. [字符编码笔记：ASCII，Unicode 和 UTF-8](http://www.ruanyifeng.com/blog/2007/10/ascii_unicode_and_utf-8.html)
4. [UTF-8 GBK UTF8 GB2312 之间的区别和关系](https://www.cnblogs.com/xiaomia/archive/2010/11/28/1890072.html)
5. [UTF-8 UTF-16 UTF-32 比较](https://juejin.im/post/5a4aeae96fb9a04512394e12)