---
layout: post
title: ff编译步骤
date: 2019-10-15 11:51:25
description: ff编译步骤
tag: ffmpeg

---

## FF编译步骤
1. core编译ffmpeg
+ 编译ffmpeg
```bash
cd C:\work\core\3rd\cmake
build.bat
```

+ 注意事项
	+ 如果安装了VS2017，但是使用VS2015编译，会因为找不到RC，修改需要D:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\bin\amd64\vcvars64.bat文件的30行为
```
@if not "%WindowsSdkDir%" == "" @set PATH=%WindowsSdkDir%bin\x64;%WindowsSdkDir%bin%WindowsSDKVersion%x64;%WindowsSdkDir%bin\x86;%WindowsSdkDir%bin%WindowsSDKVersion%x86;%PATH%
```
	+ 运行C:\work\core\3rd\cmake\build.bat编译ffmpeg库。其中build.bat中的22行修改为VS的按照目录，一般默认为C盘
	+ 如果编译ffmpeg的Debug版本，也就是build.bat的set BUILD_DEBUG=ON
	+ 编译libmfx的时候需要注意, 下载解压出来的 C:\work\local\cpp_depends_v2_build\libmfx_build-prefix\src\libmfx_build\src\mfx_load_dll.cpp 中动态导入的dll比如mfxplugin64_hw_d.dll是含有后缀_d的，而intel的驱动安装的dll都是不包含_d的，所以调用ffmpeg库动态导入dll的时候就会出现失败情况。解决办法：

2. security编译依赖的ffmpeg
+ ssn/security/scripts/env下
build-debug.sh和build.sh,必须以管理员身份运行MINGW64.exe,然后执行对应脚本.

+ 注意事项:
	+ security/scripts/env/build.bat编译的是MSVC程序,无法被go直接调用,需要使用gcc编译.MSVC编译的库不带前缀lib
	+ gcc分为msys-gcc和MinGW-gcc二种,windows下使用MinGW-gcc编译.gcc编译的库都带lib

## 参考资料:
1. []()
