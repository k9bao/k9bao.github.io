---
layout: post
title: regexp正则表达式语法
date: 2019-09-30 16:51:29
description: regexp正则表达式语法
tag: regexp

---

# regexp常用功能

- [regexp常用功能](#regexp常用功能)
  - [常用功能](#常用功能)
  - [名词解释](#名词解释)
  - [非打印字符](#非打印字符)
  - [分组语法](#分组语法)
  - [特殊字符](#特殊字符)
  - [限定符](#限定符)
  - [定位符](#定位符)
  - [参考资料](#参考资料)

## 常用功能

1. ```匹配多子串：(AAA).*?(BBB) ---含有AAA和BBB的字符串，且AAA在BBB前边。```
2. ```汉字：(\u4e00-\u9fa5)---汉字的范围```
3. ```空白行的正则表达式：\n\s*\r --- (可以用来删除空白行)```
4. ```IP地址：((?:(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d))```
5. ```匹配英文字符和数字：[A-Z,a-z,0-9]```
6. ```行首或行尾匹配替换：行首^，行尾$.```
7. ```以字符串AAA开头：(AAA).*?```

## 名词解释

1. 表达式/模式
   一个正则表达式通常被称为一个模式（pattern），为用来描述或者匹配一系列符合某个句法规则的字符串，有的地方也叫表达式。
2. 贪婪  
   贪婪模式在整个表达式匹配成功的前提下，尽可能多的匹配,属于贪婪模式的量词，也叫做匹配优先量词
3. 非贪婪  
   在整个表达式匹配成功的前提下，尽可能少的匹配
4. BRE  
   基本型正则表达式:（Basic Regular Expression，BRE）grep、vi、sed都属于BRE，是历史最早的正则表达式，因此元字符必须转译之后才具有特殊含义。
5. ERE  
   扩展型正则表达式:（Extended Regular Express，ERE），egrep、awk则属于ERE，元字符不用转译
6. Perl  
   Perl的正则表达式源自于Henry Spencer于1986年1月19日发布的regex，它已经演化成了PCRE（Perl兼容正则表达式，Perl Compatible Regular Expressions）
7. 模式（pattern）  
   一个正则表达式通常被称为一个模式（pattern），为用来描述或者匹配一系列符合某个句法规则的字符串。
8. 选择  
   竖线|代表选择（即或集），具有最低优先级。例如gray|grey可以匹配grey或gray。
9. 数量限定  
   某个字符后的数量限定符用来限定前面这个字符允许出现的个数。最常见的数量限定符包括+、?和*（不加数量限定则代表出现一次且仅出现一次）
10. 分组/子表达式/组号/组名  
    - 圆括号()可以用来定义操作符的范围和优先度，一个()就是一组
    - 默认情况下，每个分组会自动拥有一个组号，规则是：从左向右，以分组的左括号为标志，第一个出现的分组的组号为1，第二个为2，以此类推。分组0对应整个正则表达式.实际上组号分配过程是要从左向右扫描两遍的：第一遍只给未命名组分配，第二遍只给命名组分配－－因此所有命名组的组号都大于未命名的组号  
    - 你可以使用(?:exp)这样的语法来剥夺一个分组对组号分配的参与权．
    - 你也可以自己指定子表达式的组名。要指定一个子表达式的组名，请使用这样的语法：`(?<Word>\w+)`(或者把尖括号换成'也行：(?'Word'\w+)),这样就把\w+的组名指定为Word了。要反向引用这个分组捕获的内容，你可以使用`\k<Word>`
11. 后向引用  
    使用小括号指定一个子表达式后，匹配这个子表达式的文本(也就是此分组捕获的内容)可以在表达式或其它程序中作进一步的处理。例如，\1代表分组1匹配的文本
12. 元字符
    metacharacter，比如`\b \d \s \w ^ $`
13. 字符转义
    如果你想查找元字符本身的话，比如你查找.,或者*,就出现了问题：你没办法指定它们，因为它们会被解释成别的意思。这时你就得使用\来取消这些字符的特殊意义。因此，你应该使用\.和\*。当然，要查找\本身，你也得用\\.
14. 限定符
    限定符用来指定正则表达式的一个给定组件必须要出现多少次才能满足匹配。有 * 或 + 或 ? 或 {n} 或 {n,} 或 {n,m} 共6种。
15. 分枝条件
    正则表达式里的分枝条件指的是有几种规则，如果满足其中任意一种规则都应该当成匹配，具体方法是用|把不同的规则分隔开。
16. 反义
    有时需要查找不属于某个能简单定义的字符类的字符。比如想查找除了数字以外，其它任意字符都行的情况，这时需要用到反义，比如`\W \S \D \B [^x] [^aeiou]`
17. 零宽断言/负向零宽断言

```举例：
源字符串：aa<div>test1</div>bb<div>test2</div>cc
正则表达式一：<div>.*</div> #贪婪检索
匹配结果一：<div>test1</div>bb<div>test2</div>
正则表达式二：<div>.*?</div> #非贪婪检索
匹配结果二：<div>test1</div>（这里指的是一次匹配结果，所以没包括<div>test2</div>）
```

## 非打印字符  

非打印字符也可以是正则表达式的组成部分。下表列出了表示非打印字符的转义序列：
| 字符 | 描述                                                                                                                                    |
| ---- | --------------------------------------------------------------------------------------------------------------------------------------- |
| \cx  | ```匹配由x指明的控制字符。例如， \cM 匹配一个 Control-M 或回车符。x 的值必须为 A-Z 或 a-z 之一。否则，将 c 视为一个原义的 'c' 字符。``` |
| \f   | ```匹配一个换页符。等价于 \x0c 和 \cL。```                                                                                              |
| \n   | ```匹配一个换行符。等价于 \x0a 和 \cJ。```                                                                                              |
| \r   | ```匹配一个回车符。等价于 \x0d 和 \cM。```                                                                                              |
| \s   | ```匹配任何空白字符，包括空格、制表符、换页符等等。等价于 [ \f\n\r\t\v]。注意 Unicode 正则表达式会匹配全角空格符。```                   |
| \S   | ```匹配任何非空白字符。等价于 [^ \f\n\r\t\v]。```                                                                                       |
| \t   | ```匹配一个制表符。等价于 \x09 和 \cI。```                                                                                              |
| \v   | ```匹配一个垂直制表符。等价于 \x0b 和 \cK。```                                                                                          |
| \w   | ```匹配字母或数字或下划线或汉字0-9、a-z、A-Z、_（下划线）、汉字和其他国家的语言符号```                                                  |
| \W   | ```匹配非字母或数字或下划线或汉字，跟\w正好相反```                                                                                      |
| \d   | ```匹配数字```                                                                                                                          |
| \D   | ```匹配非数字```                                                                                                                        |
| []   | ```匹配[]中列举的字符```                                                                                                                |

## 分组语法

| 分类     | 代码/语法    | 说明                                                                 |
| -------- | ------------ | -------------------------------------------------------------------- |
| 捕获     | (exp)        | 匹配exp,并捕获文本到自动命名的组里                                   |
| 捕获     | (?<name>exp) | 匹配exp,并捕获文本到名称为name的组里，也可以写成(?'name'exp)         |
| 捕获     | (?:exp)      | 匹配exp,不捕获匹配的文本，也不给此分组分配组号                       |
| 零宽断言 | (?=exp)      | 匹配exp前面的位置                                                    |
| 零宽断言 | (?<=exp)     | 匹配exp后面的位置                                                    |
| 零宽断言 | (?!exp)      | 匹配后面跟的不是exp的位置                                            |
| 零宽断言 | (?<!exp)     | 匹配前面不是exp的位置                                                |
| 注释     | (?#comment)  | 这种类型的分组不对正则表达式的处理产生任何影响，用于提供注释让人阅读 |

## 特殊字符

所谓特殊字符，就是一些有特殊含义的字符，```如上面说的 runoo*b 中的 *，简单的说就是表示任何字符串的意思。如果要查找字符串中的 * 符号，则需要对 * 进行转义，即在其前加一个 \: runo\*ob 匹配 runo*ob。```

许多元字符要求在试图匹配它们时特别对待。若要匹配这些特殊字符，必须首先使字符"转义"，即，将反斜杠字符\ 放在它们前面。下表列出了正则表达式中的特殊字符

| 字符      | 描述                                                                                                                                                                                                                       |
| --------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| $         | ```匹配输入字符串的结尾位置。如果设置了 RegExp 对象的 Multiline 属性，则 $ 也匹配 '\n' 或 '\r'。要匹配 $ 字符本身，请使用 \$。```                                                                                          |
| (pattern) | ```匹配pattern并获取这一匹配的子字符串。该子字符串用于向后引用。所获取的匹配可以从产生的Matches集合得到，在VBScript中使用SubMatches集合，在JScript中则使用$0…$9属性。要匹配圆括号字符，请使用“\(”或“\)”。可带数量后缀。``` |
| *         | ```匹配前面的子表达式零次或多次。要匹配 * 字符，请使用 \*。贪婪的```                                                                                                                                                       |
| +         | ```匹配前面的子表达式一次或多次。要匹配 + 字符，请使用 \+。贪婪的```                                                                                                                                                       |
| .         | ```匹配除换行符 \n 之外的任何单字符。要匹配 . ，请使用 \. 。```                                                                                                                                                            |
| [         | ```标记一个中括号表达式的开始。要匹配 [，请使用 \[。```                                                                                                                                                                    |
| ?         | ```匹配前面的子表达式零次或一次，或指明一个非贪婪限定符。要匹配 ? 字符，请使用 \?。```                                                                                                                                     |
| \         | ```将下一个字符标记为或特殊字符、或原义字符、或向后引用、或八进制转义符。例如， 'n' 匹配字符 'n'。'\n' 匹配换行符。序列 '\\' 匹配 "\"，而 '\(' 则匹配 "("。```                                                             |
| ^         | ```匹配输入字符串的开始位置，除非在方括号表达式中使用，此时它表示不接受该字符集合。要匹配 ^ 字符本身，请使用 \^。```                                                                                                       |
| {         | ```标记限定符表达式的开始。要匹配 {，请使用 \{。```                                                                                                                                                                        |
|           |                                                                                                                                                                                                                            | ```指明两项之间的一个选择。要匹配 |，请使用 \|。``` |

## 限定符

限定符用来指定正则表达式的一个给定组件必须要出现多少次才能满足匹配。有 * 或 + 或 ? 或 {n} 或 {n,} 或 {n,m} 共6种。

正则表达式的限定符有：
| 字符  | 描述                                                                                                                                                                           |
| ----- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| *     | ```匹配前面的子表达式零次或多次。例如，zo* 能匹配 "z" 以及 "zoo"。* 等价于{0,}。```                                                                                            |
| +     | ```匹配前面的子表达式一次或多次。例如，'zo+' 能匹配 "zo" 以及 "zoo"，但不能匹配 "z"。+ 等价于 {1,}。```                                                                        |
| ?     | ```匹配前面的子表达式零次或一次。例如，"do(es)?" 可以匹配 "do" 、 "does" 中的 "does" 、 "doxy" 中的 "do" 。? 等价于 {0,1}。```                                                 |
| {n}   | ```n 是一个非负整数。匹配确定的 n 次。例如，'o{2}' 不能匹配 "Bob" 中的 'o'，但是能匹配 "food" 中的两个 o。```                                                                  |
| {n,}  | ```n 是一个非负整数。至少匹配n 次。例如，'o{2,}' 不能匹配 "Bob" 中的 'o'，但能匹配 "foooood" 中的所有 o。'o{1,}' 等价于 'o+'。'o{0,}' 则等价于 'o*'。```                       |
| {n,m} | ```m 和 n 均为非负整数，其中n <= m。最少匹配 n 次且最多匹配 m 次。例如，"o{1,3}" 将匹配 "fooooood" 中的前三个 o。'o{0,1}' 等价于 'o?'。请注意在逗号和两个数之间不能有空格。``` |

## 定位符

定位符使您能够将正则表达式固定到行首或行尾。它们还使您能够创建这样的正则表达式，这些正则表达式出现在一个单词内、在一个单词的开头或者一个单词的结尾。

定位符用来描述字符串或单词的边界，^ 和 $ 分别指字符串的开始与结束，\b 描述单词的前或后边界，\B 表示非单词边界。

正则表达式的定位符有：
| 字符 | 描述                                                                                                        |
| ---- | ----------------------------------------------------------------------------------------------------------- |
| ^    | ```匹配输入字符串开始的位置。如果设置了 RegExp 对象的 Multiline 属性，^ 还会与 \n 或 \r 之后的位置匹配。``` |
| $    | ```匹配输入字符串结尾的位置。如果设置了 RegExp 对象的 Multiline 属性，$ 还会与 \n 或 \r 之前的位置匹配。``` |
| \b   | ```匹配一个单词边界，即字与空格间的位置。比如：ter\b匹配 is Chapter char但是不匹配 is Chaptera char```      |
| \B   | ```非单词边界匹配。ter\B匹配 is Chaptera char但是不匹配is Chapter char,与\b相反，不是单词的边界```          |

## 参考资料

1. [go正则实例](https://studygolang.com/articles/104)
2. [贪婪与非贪婪模式](https://blog.csdn.net/lxcnn/article/details/4756030)
3. [csdn正则表达式](https://blog.csdn.net/knowledgebao/article/details/85324489)
4. [在下编辑器](https://regex101.com/)
5. [wiki](https://zh.wikipedia.org/wiki/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F)
6. [正则表达式30分钟入门教程](https://deerchao.cn/tutorials/regex/regex.htm#backreference)