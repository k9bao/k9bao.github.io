---
layout: post
title: bat
date: 2019-11-22 13:31:01
description: bat
tag: bat

---
# bat命令

## 常用命令

### if

if 条件表达式 (语句1) else (语句2)，它的含义是：如果条件表达式成立，那么，就执行语句1，否则，将执行语句2。

1、判断驱动器、文件或文件夹是否存在，用 if exist 语句
例如：if exist c:\xue51com.txt (echo c盘下有xue51com.txt存在) else (echo c盘下不存在xue51com.txt)

2、判断某两个字符串是否相等，用 if "字符串1"=="字符串2" 语句
例如：if "xue"=="xyz" (echo 字符串xue等于字符串xyz) else (echo 字符串xue不等于字符串xyz)，这个例子主要是检测字符串(注意，用if检测字符串是否相等的时候，后面用的不是“=”，而是“==”)

3、判断某两个数值是否相等，用 if 数值1 equ 数值2 语句
举例：if 1 equ 2 (echo 1等于2) else (echo 1不等于2)，这个例子功能是检测数值：
（注意，批处理中大于符号不能用：“>”,而用"gtr"，其它的也类似）
比较运算符一览
EQU - 等于
NEQ - 不等于
LSS - 小于
LEQ - 小于或等于
GTR - 大于
GEQ - 大于或等于

4、判断某个变量是否已经被赋值，用 if defined str 语句
举例：if defined str (echo 变量str已经被赋值，其值为%str%) else (echo 变量str的值为空)

5、if结合errorlevel使用
说明：环境变量errorlevel的初始值为0，当一些命令执行不成功，就会返回一个数值，如：1 ，2 等
IF-ERRORLEVEL
举例：
XCOPY F:\test.bat D:\
IF ERRORLEVEL 1 ECHO 文件拷贝失败
IF ERRORLEVEL 0 ECHO 成功拷贝文件
如果文件拷贝成功，屏幕就会显示“成功拷贝文件”，否则就会显示“文件拷贝失败”
IF ERRORLEVEL 是用来测试它的上一个DOS命令的返回值的，注意只是上一个命令的返回值，而且返回值必须依照从大到小次序顺序判断。

- set PROJECT_DIR=%CD% 通过set定义和设置变量,通过%%访问变量内容
- rem和::都起到注释的作用，然而又有些不同。 rem是一条命令，在运行的时候相当于把rem本身及其后面的内容置空。既然它是一条命令，就必须处于单独的一行或者有类似“&”的连接符号连接。
  - 批处理遇到以冒号“:”开头的行时（忽略冒号前的空格），会将其后的语句识别为“标记”而不是命令语句，因此类似“:label”这样的东东在批处理中仅仅是一个标记。
  - 对于“::”而言，之所以可以达到注释的效果，是因为第二个:不是标签的合法字符（把它换成\;.等等都行），它不被当作一个合法的标签这一点很好理解，如果在你的批处理中有一个永远用不到的标签hero，那么你以用“:hero”打头来作为注释。只不过冒号有其先天的优越性--语法上的问题。
- echo on和echo off,打开命令回显
- pushd和 popd
  - 每次使用 pushd 命令时，都存储一个目录供用户使用。但是，可以通过多次使用 pushd 命令存储多个目录。
  - 目录按顺序储存到一个虚拟堆栈中。如果第一次使用 pushd 命令，该命令所在的目录就会被置于栈底。如果您再次使用该命令，则第二个目录就会被置于第一个目录之上。每次使用 pushd 命令时都将重复该过程。启用了命令扩展，pushd 命令将接收网络路径或本地驱动器盘符和路径。
  - 可以用 popd 命令将当前目录更改为由 pushd 命令最新存储的目录。如果使用 popd 命令，位于堆栈顶端的目录将从堆栈中删除，当前目录转变为栈顶目录。如果再次使用 popd 命令，则删除堆栈中的下一个目
  - 如果指定网络路径，pushd 命令临时将第一个未使用的驱动器盘符（从 Z 开始）分配到指定的网络资源。然后命令将当前驱动器和目录更改为新分配驱动器上的指定目录。如果与已启用的命令扩展一起使用 popd ，popd 命令将删除由 pushd 创建的驱动器盘符分配。
- %cd% 可以用在批处理文件中，也可以用在命令行中;
  - 展开后，是驱动器盘符:+当前目录，如在dos窗口中进入c:\dir目录下面，输入：echo %cd% ，则显示为：c:\dir 。
  - %cd%的内容是可以被改变的，其内容为命令的执行路径或批处理文件的执行路径。
- %Num : %0 指批处理本身。%1 指批处理文件名后加的以空格分隔的字符串。%2~%9类推

## 参考资料

1. [DOS/BAT批处理if exist else 语句的几种用法](https://www.cnblogs.com/yang-hao/p/6003149.html)
